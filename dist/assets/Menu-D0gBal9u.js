import{r as i,c as l,d as u,j as e,e as p,s as d,f as j,M as g,u as m,g as N,b,V as o,P as v}from"./index-BZiLoYku.js";import{G as y,A as w}from"./AppLayout-DYW4N5im.js";import{S as L}from"./SetupOrderButton-BtpcmQRF.js";import{u as z}from"./useMutation-DoKyTced.js";function I({data:s}){const[t,n]=i.useState(!1),c=l(),r=u(a=>a.orderItems.pizzas.find(h=>h.id===s.id)?.number||0);function f(a){c(p(a)),n(!0)}return i.useEffect(()=>{r===0&&n(!1)},[r]),e.jsx("li",{className:"mx-auto font-Vazirmatn",children:e.jsxs("div",{className:"flex p-2 gap-x-3",children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsx("h3",{className:"font-bold text-right",children:s.pizza_name}),e.jsx("p",{className:"font-thin text-right",children:s.description}),e.jsxs("div",{className:"flex justify-between w-full",children:[t?e.jsx("div",{className:"flex gap-x-1",children:e.jsx(L,{id:s.id,number:r})}):e.jsx("button",{onClick:()=>f(s),className:"bg-yellow-400 cursor-pointer rounded-full p-1 px-3 ",children:"ثبت سفارش"}),e.jsxs("span",{children:[s.price,"$"]})]})]}),e.jsx("div",{children:e.jsx("img",{src:s.image,className:"h-24"})})]})})}async function M(){const{data:s,error:t}=await d.from("menu").select("*");if(t)throw new Error(t.message);return s}function S(){const{data:s,isLoading:t,error:n}=j({queryFn:M,queryKey:g});return{data:s,isLoading:t,error:n}}function C(){const s=m(),t=l();return e.jsxs("div",{className:"my-2 flex justify-center gap-x-2",children:[e.jsx("button",{onClick:()=>s("/order"),className:"bg-green-300 rounded-full p-2 cursor-pointer",children:"تکمیل سفارش"}),e.jsx("button",{onClick:()=>t(N()),className:"bg-red-400 rounded-full p-2 cursor-pointer",children:"خالی کردن لیست سفارش"})]})}function x({children:s}){return e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("p",{className:"font-bold",children:[s," "]})})}function E(s){return y({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M312 372c-7.7 0-14 6.3-14 14 0 9.9-8.1 18-18 18H94c-9.9 0-18-8.1-18-18V126c0-9.9 8.1-18 18-18h186c9.9 0 18 8.1 18 18 0 7.7 6.3 14 14 14s14-6.3 14-14c0-25.4-20.6-46-46-46H94c-25.4 0-46 20.6-46 46v260c0 25.4 20.6 46 46 46h186c25.4 0 46-20.6 46-46 0-7.7-6.3-14-14-14z"},child:[]},{tag:"path",attr:{d:"M372.9 158.1c-2.6-2.6-6.1-4.1-9.9-4.1-3.7 0-7.3 1.4-9.9 4.1-5.5 5.5-5.5 14.3 0 19.8l65.2 64.2H162c-7.7 0-14 6.3-14 14s6.3 14 14 14h256.6L355 334.2c-5.4 5.4-5.4 14.3 0 19.8l.1.1c2.7 2.5 6.2 3.9 9.8 3.9 3.8 0 7.3-1.4 9.9-4.1l82.6-82.4c4.3-4.3 6.5-9.3 6.5-14.7 0-5.3-2.3-10.3-6.5-14.5l-84.5-84.2z"},child:[]}]})(s)}async function k(){const{error:s,data:t}=await d.auth.signOut();if(s)throw new x("مشکلی به وجود امده است")}function O(){const s=m(),t=b(),{mutate:n}=z({mutationFn:k,onError:c=>o.error(c.message),onSuccess:()=>{o.success("با موفقیت خارج شدید"),t.removeQueries(),s("/login")}});return{mutateLogout:n}}function V(){const{mutateLogout:s}=O();return e.jsxs("div",{className:"flex cursor-pointer items-center gap-x-2 p-2 mt-3",children:[e.jsx("span",{className:"font-bold ",onClick:()=>s(),children:"خروج"}),e.jsx(E,{})]})}function q(){const{data:s,isLoading:t,error:n}=S(),c=u(r=>r.orderItems.pizzas.length>=1);return e.jsxs("div",{className:"relative min-h-[300px]",children:[e.jsx(V,{}),t&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(v,{size:20,color:"#bfc1c5"})}),n&&e.jsx(x,{children:" مشکلی پیش امده لطفا صفخه را دوباره بارگزاری کنید"}),e.jsx("ul",{className:"flex flex-wrap",children:s?.map(r=>e.jsx(I,{data:r},r.id))}),c&&e.jsx(C,{})]})}function Q(){return e.jsx("main",{children:e.jsx(w,{children:e.jsx(q,{})})})}export{Q as default};
